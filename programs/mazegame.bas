
REM AMAZING.BAS

REM LOAD RNG AS SEED
1 S = RND(-PEEK(53247)): GOTO 100

REM READ A KEY
REM GOSUB HERE FOR A = KEYBOARD
10 IF PEEK(53265) < 128 THEN 10
11 A = PEEK(53264) - 128: RETURN

REM CLEAR SCREEN
20 PRINT CHR$(27);"[2J";CHR$(27);"[H";:RETURN

REM INIT
100 MX=20:MY=20:DX=6:DY=6:HX=INT(DX/2):HY=INT(DX/2):CX=HX+1:CY=HY+1
110 DIM W(MX,MY), V(MX,MY), D(DX,DY)

REM ESCAPE - quit
REM LEFT - H
REM DOWN - J
REM UP - K
REM RIGHT - L
120 K$=CHR$(27)+"HJKL": KL=LEN(K$)
130 M$="WEST SOUTHNORTHEAST "


150 GOSUB 20: PRINT:PRINT "Digging Maze": PRINT


180 Q=0:Z=0:E=INT(RND(1)*MX+1):X=E
190 T=MX*MY+1:C=1:W(X,1)=C:C=C+1
200 R=X:S=1:GOTO 260

REM LOOK FOR A SPOT WE HAVE BEEN TO
210 IF R<>MX THEN 240
215 IF S<>MY THEN 230
220 R=1:S=1:GOTO 250
230 R=1:S=S+1:GOTO 250
240 R=R+1 
250 IF W(R,S)=0 THEN 210

REM ARE WE ON THE LEFT COL?
260 IF R-1=0 THEN 530
REM HAVE WE BEEN LEFT?
265 IF W(R-1,S)<>0 THEN 530

REM ARE WE ON THE TOP ROW?
270 IF S-1=0 THEN 390
REM HAVE WE BEEN UP
280 IF W(R,S-1)<>0 THEN 390

290 IF R=MX THEN 330
300 IF W(R+1,S)<>0 THEN 330

310 X=INT(RND(1)*3+1)
320 ON X GOTO 790,820,860

330 IF S<>MY THEN 340
334 IF Z=1 THEN 370
338 Q=1:GOTO 350
340 IF W(R,S+1)<>0 THEN 370

350 X=INT(RND(1)*3+1)
360 ON X GOTO 790,820,910
370 X=INT(RND(1)*2+1)
380 ON X GOTO 790,820

390 IF R=MX THEN 470
400 IF W(R+1,S)<>0 THEN 470
405 IF S<>MY THEN 420
410 IF Z=1 THEN 450
415 Q=1:GOTO 430
420 IF W(R,S+1)<>0 THEN 450

430 X=INT(RND(1)*3+1)
440 ON X GOTO 790,860,910
450 X=INT(RND(1)*2+1)
460 ON X GOTO 790,860

470 IF S<>MY THEN 490
480 IF Z=1 THEN 520
485 Q=1:GOTO 500
490 IF W(R,S+1)<>0 THEN 520

500 X=INT(RND(1)*2+1)
510 ON X GOTO 790,910

520 GOTO 790
530 IF S-1=0 THEN 670
540 IF W(R,S-1)<>0 THEN 670
545 IF R=MX THEN 610
547 IF W(R+1,S)<>0 THEN 610
550 IF S<>MY THEN 560
552 IF Z=1 THEN 590
554 Q=1:GOTO 570
560 IF W(R,S+1)<>0 THEN 590

570 X=INT(RND(1)*3+1)
580 ON X GOTO 820,860,910
590 X=INT(RND(1)*2+1)
600 ON X GOTO 820,860

610 IF S<>MY THEN 630
620 IF Z=1 THEN 660
625 Q=1:GOTO 640
630 IF W(R,S+1)<>0 THEN 660

640 X=INT(RND(1)*2+1)
650 ON X GOTO 820,910

660 GOTO 820
670 IF R=MX THEN 740
680 IF W(R+1,S)<>0 THEN 740
685 IF S<>MY THEN 700
690 IF Z=1 THEN 730
695 Q=1:GOTO 830
700 IF W(R,S+1)<>0 THEN 730

710 X=INT(RND(1)*2+1)
720 ON X GOTO 860,910

730 GOTO 860
740 IF S<>MY THEN 760
750 IF Z=1 THEN 780
755 Q=1:GOTO 770
760 IF W(R,S+1)<>0 THEN 780
770 GOTO 910
780 GOTO 990

790 W(R-1,S)=C 
800 C=C+1:V(R-1,S)=2:R=R-1
810 IF C=T THEN 1000
815 Q=0:GOTO 260

820 W(R,S-1)=C 
830 C=C+1
840 V(R,S-1)=1:S=S-1:IF C=T THEN 1000
850 Q=0:GOTO 260

860 W(R+1,S)=C 
870 C=C+1:IF V(R,S)=0 THEN 880
875 V(R,S)=3:GOTO 890
880 V(R,S)=2
890 R=R+1
900 IF C=T THEN 1000
905 GOTO 530

910 IF Q=1 THEN 960

920 W(R,S+1)=C 
922 C=C+1:IF V(R,S)=0 THEN 940
930 V(R,S)=3:GOTO 950
940 V(R,S)=1
950 S=S+1:IF C=T THEN 1000
955 GOTO 260

960 Z=1:F=R
970 IF V(R,S)=0 THEN 980
975 V(R,S)=3:Q=0:GOTO 990
980 V(R,S)=1:Q=0:R=1:S=1:GOTO 250

990 GOTO 210

REM PLAYER STARTS AT THE ENTRANCE
1000 PY = 1: PX = E

REM COPY V to D -- D contains 6x6 of the maze
1100 Y = 1: FOR VY = PY - HY TO PY + HY - 1 
1110 X = 1: FOR VX = PX - HX TO PX + HX - 1
REM WE LOOKING AT THE ENTRANCE?
1120 IF (VY = 0 AND VX = E) THEN D(X, Y) = 1: GOTO 1160
1130 IF VY < 1 OR VY > MY OR VX < 1 OR VX > MX THEN D(X, Y) = 0: GOTO 1160 
1140 D(X, Y) = V(VX, VY)
1160 X = X + 1: NEXT VX
1170 Y = Y + 1: NEXT VY

REM PRINT OUT D()
1200 GOSUB 20: FOR X = 2 TO DX
1210 Q = D(X, 1)
1220 IF Q = 2 OR Q = 0 THEN PRINT "+--";: GOTO 1240

1230 PRINT "+  ";
1240 NEXT X
1250 PRINT "+"
1260 FOR Y = 2 TO DY
1270 IF D(1, Y) < 2 THEN PRINT "|";: GOTO 1290
1280 PRINT " ";
1290 FOR X = 2 TO DX - 1                                  
1300 IF X = CX AND Y = CY THEN PRINT "**";: GOTO 1320
1310 PRINT "  ";
1320 IF D(X, Y) < 2 THEN PRINT "|";: GOTO 1340
1330 PRINT " ";
1340 NEXT X
1345 PRINT "  ";
1350 IF D(DX, Y) < 2 THEN PRINT "|": GOTO 1370
1360 PRINT " " 
1370 FOR X = 2 TO DX 
1380 Q = D(X, Y)
1390 IF Q = 2 OR Q = 0 THEN PRINT "+--";: GOTO 1410
1400 PRINT "+  ";
1410 NEXT X
1420 PRINT "+"
1430 NEXT Y
 
1500 IF PY > MY AND PX = F THEN 5000

REM WHICH WAY DO WE GO? VIM Keys!
2000 GOSUB 10

2010 A$=CHR$(A): K=0
2020 FOR KC=1 TO KL
2030 IF MID$(K$, KC, 1) = A$ THEN K=KC
2040 NEXT KC
2050 ON K GOTO 5000,2100,2200,2300,2400

2090 GOTO 2000

REM LETS MOVE THROUGH THE MAZE NOW
REM MOVE LEFT?
2100 IF PX = 1 THEN 2000
2110 Q = V(PX - 1, PY): IF Q < 2 THEN 2000
2120 PX = PX - 1: M=1: GOTO 2500

REM MOVE DOWN
2200 Q = V(PX, PY): IF Q = 2 OR Q = 0 THEN 2000
2210 PY = PY + 1: M=6: GOTO 2500

REM MOVE UP?
2300 IF PY = 1 THEN 2000
2310 Q = V(PX, PY - 1): IF Q = 2 OR Q = 0 THEN 2000
2320 PY = PY - 1: M=11: GOTO 2500

REM MOVE RIGHT?
2400 Q = V(PX, PY): IF Q < 2 THEN 2000
2410 PX = PX + 1: M=16: GOTO 2500

2500 PRINT "MOVING ";MID$(M$, M, 5)

2990 GOTO 1100

5000 PRINT "YOU ESCAPED!"
REM EXIT EMU
5010 POKE 53279,1

RUN